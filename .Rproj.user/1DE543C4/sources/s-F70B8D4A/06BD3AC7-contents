--- 
title: "4 장"
author: "윤 재호"
date: "`r Sys.Date()`"
site: bookdown::bookdown_site
output: bookdown::gitbook
documentclass: book
---


# 단순회위 모형


## 데이타 

```{r , echo = TRUE}
food = read.table(url("http://www.principlesofeconometrics.com/poe4/data/dat/food.dat"),header=F)
```

```{r , echo = TRUE}
head(food)         
```

## 데이타 요약

```{r , echo = TRUE}
summary(food)      # Summary statistics 
```

## 데이타 그림

```{r }
plot(food)         # Plot matrix 
```


# 모형

$$ Y_{i} = \alpha + \beta X_{i} + e_{i} $$


## 변수  

```{r }
x = food[,2]   # Income
y = food[,1]   # Food Expenditure
```


## 추정 

```{r }
reg <- lm(y ~ x)
```


## 추정 결과

```{r }
summary(reg)  
```


##  b1, b2 

```{r }
b1 <- coef(reg)[[1]] 
b2 <- coef(reg)[[2]]

b1
b2
```

# 예측   

```{r }
N <- 40
sde <- 89.52
y1 <- b1+b2*x+rnorm(N, mean=0, sd=sde)

y2 <- data.frame()
y2 <- cbind(y1, y)

```

## 예측 (1회)  

```{r }
matplot(y1, type='l', col=1:40,
        xlab='Income', ylab='Food Expenditure', 
        main ='Prediction N=1 ')

```

## 예측 (1회)  

```{r }
matplot(y2, type='l', col=1:40,
        xlab='Income', ylab='Food Expenditure', 
        main ='Food Expenditure vs. Prediction ')
```

## 예측 (1,000회)  

```{r }
b1 <- coef(reg)[[1]] 
b2 <- coef(reg)[[2]]
yy <- data.frame()

trial <- 1
trials <- 1000
while(trial <= trials) {
  y3 <- b1+b2*x+rnorm(N, mean=0, sd=sde)
  yy <- rbind(yy, t(y3))
  trial <- trial + 1
}

```

## 예측 (1,000회)  

```{r }
matplot(t(yy), type='l', col=1:40,
        xlab='Income', ylab='Food Expenditure', 
        main ='Prediction N=1000 ')
```

## 화일 저장

sink('ch4.out')
```{r }
# Least sqaures prediction (one time) 

y1

```
sink()


# 참고자료 
- Principles of Econometrics with R 
<https://bookdown.org/ccolonescu/RPoE4/>
- Principles of Econometrics  
<http://www.principlesofeconometrics.com/poe4/poe4.htm>
- Beowulfkorea  
<https://sites.google.com/site/beowulfkorea/yoon/r> 

